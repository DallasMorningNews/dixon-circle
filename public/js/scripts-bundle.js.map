{"version":3,"sources":["+custom.js"],"names":["$","document","ready","drawMap","locations","map","addSource","type","data","addLayer","id","source","paint","circle-radius","stops","circle-color","circle-opacity","on","e","features","queryRenderedFeatures","point","layers","length","feature","popup","setLngLat","geometry","coordinates","setHTML","properties","number","addTo","animateMap","getCanvas","style","cursor","location","zoom","duration","pitch","easeTo","center","updateLoc","visibleLocs","windowTop","window","scrollTop","windowHeight","height","windowBottom","each","this","offset","top","push","attr","l","currentLoc","undefined","originalLoc","remove","mapboxgl","Popup","expandMap","hasClass","removeClass","addClass","d","Date","year","getFullYear","text","lng","lat","GeoJSON","parse","Point","include","accessToken","Map","container","scrollZoom","disable","addControl","Navigation","_","throttle","scroll","click","storyItem","siblings","target","index","parent","eq"],"mappings":"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","file":"scripts-bundle.js","sourcesContent":["$(document).ready(function() {\n\n\t//custom scripting goes here\n\n\t// injecting current year into footer\n\t// DO NOT DELETE\n\n\tvar d = new Date();\n\tvar year = d.getFullYear();\n\n\t$('.copyright').text(year);\n\n\n\n\n\n\t// some code blocks require javascript to function, like slideshows, synopsis blocks, etc\n\t// you can find that code here: https://github.com/DallasMorningNews/generator-dmninteractives/wiki/Cookbook\n\n\tvar originalLoc = [-96.7371063,32.7628376];\n\n\tvar locations = [\n\t\t{number: \"1\", lng: -96.7332026, lat: 32.7651497},\n\t\t{number: \"2\", lng: -96.7353841, lat: 32.7637329},\n\t\t{number: \"3\", lng: -96.7342684, lat: 32.763229},\n\t\t{number: \"4\", lng: -96.7334224, lat: 32.7643927},\n\t\t{number: \"5\", lng: -96.7342638, lat: 32.7643172},\n\t\t{number: \"6\", lng: -96.7385599, lat: 32.7614752},\n\t\t{number: \"7\", lng: -96.7347115, lat: 32.7652384},\n\t\t{number: \"8\", lng: -96.7337592, lat: 32.763672}\n\t];\n\n\tlocations = GeoJSON.parse(locations, {Point: ['lat', 'lng'], include: ['number']});\n\n\n\n\t////////////////////////////////////////////////\n\t///// MAP SETUP ////////////////////////////////\n\t////////////////////////////////////////////////\n\n\t// definiing our popup. We'll position, populate it with content and add it\n\t// to the map later with a click or scroll\n\tvar popup = new mapboxgl.Popup();\n\n\tmapboxgl.accessToken = 'pk.eyJ1IjoibWFjbWFuIiwiYSI6ImVEbmNmZjAifQ.zVzy9cyjNT1tMYOTex51HQ';\n\n\n\t// defining the map and it's starting parameters\n\tvar map = new mapboxgl.Map({\n\t\tcontainer: 'map',\n\t\tstyle: 'mapbox://styles/mapbox/satellite-streets-v9',\n\t\tcenter: originalLoc,\n\t\tzoom: 15\n\t});\n\n\t// once the map has loaded, disable scroll zooming and add a zoom navigation\n\t// then draw the map using our location data\n\tmap.on(\"load\", function() {\n\t\tmap.scrollZoom.disable();\n\t\tmap.addControl(new mapboxgl.Navigation());\n\n\t\tdrawMap(locations);\n\t});\n\n\n\t////////////////////////////////////////////////\n\t///// MAP DRAWING //////////////////////////////\n\t////////////////////////////////////////////////\n\n\tfunction drawMap(locations) {\n\n\t\t// adding the data source\n\t\tmap.addSource(\"locations\", {\n\t\t\ttype: \"geojson\",\n\t\t\tdata: locations\n\t\t});\n\n\t\t// adding the data layer\n\t\tmap.addLayer({\n\t\t\t\"id\": \"dixonCircle\",\n\t\t\t\"source\": \"locations\",\n\t\t\t\"type\": \"circle\",\n\t\t\t\"paint\": {\n\t\t\t\t\"circle-radius\": {\n\t\t\t\t\tstops: [[1, 11], [8, 9], [16, 7]]\n\t\t\t\t},\n\t\t\t\t\"circle-color\": \"#d73027\",\n\t\t\t\t\"circle-opacity\": 1\n\t\t\t}\n\t\t});\n\n\t\t// on click, populate, position and add the popup to the map,\n\t\t// then animate the map to the clicked position\n\t\tmap.on(\"click\", function(e){\n\t\t\tvar features = map.queryRenderedFeatures(e.point, {layers: ['dixonCircle']});\n\n\t\t\tif (!features.length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar feature = features[0];\n\n\t\t\tpopup.setLngLat(feature.geometry.coordinates)\n\t\t\t\t.setHTML(feature.properties.number)\n\t\t\t\t.addTo(map);\n\n\t\t\tanimateMap(features[0].geometry.coordinates, 17, 750, 0);\n\n\t\t});\n\n\t\t// when mousing over a feature (i.e., a dot on the map), make the cursor a pointer\n\t\tmap.on('mousemove', function(e) {\n\t\t\tvar features = map.queryRenderedFeatures(e.point, {layers: ['dixonCircle']});\n\t\t\tmap.getCanvas().style.cursor = (features.length) ? 'pointer' : '';\n\t\t});\n\t}\n\n\n\t////////////////////////////////////////////////\n\t///// MAP ANIMATING ////////////////////////////\n\t////////////////////////////////////////////////\n\n\t// function to animate the map, handling locaiton, zoom, duration and pitch\n\tfunction animateMap(location, zoom, duration, pitch) {\n\t\tmap.easeTo({\n\t\t\tcenter: location,\n\t\t\tzoom: zoom,\n\t\t\tduration: duration,\n\t\t\tpitch: pitch\n\t\t});\n\t}\n\n\n\t// reseting the map to it's original orientation with a click of the reset button\n\t$(\"#mapReset\").on(\"click\", function() {\n\t\tanimateMap(originalLoc, 15, 750, 0);\n\t\tpopup.remove();\n\t\tpopup = new mapboxgl.Popup();\n\t});\n\n\n\t////////////////////////////////////////////////\n\t///// UPDATING THE MAP POSITION ////////////////\n\t////////////////////////////////////////////////\n\n\t// as we scroll through our content, we're going to animate the map center\n\t// location to correspoinding features within our content\n\n\t// variable set up. we need an array of ids for all the locaitons that have passed the\n\t// bottom of the screen, and a variable to hold the current visible location\n\tvar visibleLocs = [];\n\tvar currentLoc;\n\n\tfunction updateLoc() {\n\n\t\t// empty the visible locations array\n\t\tvisibleLocs = [];\n\n\n\t\t// set our window dimension variables\n\t\tvar windowTop = $(window).scrollTop();\n\t\tvar windowHeight = $(window).height();\n\t\tvar windowBottom = windowHeight + windowTop;\n\n\t\t// for each location section, if it's visible (i.e., above the windowBottom), push\n\t\t// that section's id to the visibleLocs array\n\t\t$.each($(\".dixonSection\"), function() {\n\t\t\tif (windowBottom > $(this).offset().top + 200) {\n\t\t\t\tvisibleLocs.push($(this).attr(\"id\"));\n\t\t\t}\n\t\t});\n\n\t\t// now, if everything goes right, the last id in the array is the card\n\t\t// closest to the bottom of the screen\n\n\t\t// find out how many locations we're dealing with so we can grab the last one\n\t\tvar l = visibleLocs.length;\n\n\t\t// if the last location in the visible array isn't the same as our current location\n\t\t// grab that locations lat and long and zoom the map\n\n\t\tif (visibleLocs[l-1] !== currentLoc && visibleLocs[l-1] !== undefined) {\n\n\t\t\t// position the map\n\t\t\tanimateMap(locations.features[l-1].geometry.coordinates, 17, 750, 0);\n\n\t\t\t// display the correspoinding popup for the current location\n\t\t\tpopup.setLngLat(locations.features[l-1].geometry.coordinates)\n\t\t\t\t.setHTML(locations.features[l-1].properties.number)\n\t\t\t\t.addTo(map);\n\n\t\t\t// set the current location to the last visible location\n\t\t\tcurrentLoc = visibleLocs[l-1];\n\n\t\t// else, if visibleLocs is empty zoom the map back to the original view\n\n\t\t} else if (visibleLocs[l-1] === undefined) {\n\t\t\tanimateMap(originalLoc, 15, 750, 0);\n\t\t\tpopup.remove();\n\t\t\tpopup = new mapboxgl.Popup();\n\t\t\tcurrentLoc = \"\";\n\t\t}\n\n\t\t// if we get all the way to the end, and the credits div scrolls into view,\n\t\t// recenter and zoom the map to it's starting lat, long and zoom\n\t\tif (windowBottom > $(\".credits\").offset().top) {\n\t\t\tanimateMap(originalLoc, 15, 750, 0);\n\t\t\tpopup.remove();\n\t\t\tpopup = new mapboxgl.Popup();\n\t\t}\n\n\t}\n\n\t// throttle the updateLoc function to run every 600 milliseconds\n\t$(window).on(\"scroll\", _.throttle(updateLoc, 600));\n\n\t// animate our reset and zoom controls based on if the black bar has scrolled out of view\n\t$(window).scroll(function() {\n\t\tif ($(window).scrollTop() > 52) {\n\t\t\t$(\"#mapReset\").addClass(\"moved\");\n\t\t\t$(\".mapboxgl-ctrl-top-right\").addClass(\"moved\");\n\t\t\t$(\"#mapExpander\").addClass(\"moved\");\n\t\t} else {\n\t\t\t$(\"#mapReset\").removeClass(\"moved\");\n\t\t\t$(\".mapboxgl-ctrl-top-right\").removeClass(\"moved\");\n\t\t\t$(\"#mapExpander\").removeClass(\"moved\");\n\t\t}\n\t});\n\n\n\tfunction expandMap() {\n\t\tif ($(\"#map\").hasClass(\"viewable\") === true) {\n\t\t\t$(\"#map\").removeClass(\"viewable\");\n\t\t\t$(\"#mapExpander\").removeClass(\"fa-times\").addClass(\"fa-map-marker\");\n\t\t\t$(\"body\").removeClass(\"noScroll\");\n\t\t} else {\n\t\t\t$(\"#map\").addClass(\"viewable\");\n\t\t\t$(\"#mapExpander\").removeClass(\"fa-map-marker\").addClass(\"fa-times\");\n\t\t\t$(\"body\").addClass(\"noScroll\");\n\t\t}\n\t}\n\n\t$(\"#mapExpander\").click(function() {\n\t\texpandMap();\n\t});\n\n\t$(\".mapper\").click(function() {\n\t\texpandMap();\n\t});\n\n\n\t////////////////////////////////////////////////\n\t///// VIEWING STORIES WITHIN SECTIONS //////////\n\t////////////////////////////////////////////////\n\n\tvar storyItem = $(\".dixonStories ul li\");\n\n\tstoryItem.click(function() {\n\n\t\t// add the activeItem class to the li clicked\n\t\t// and remove it from any siblings that have it\n\t\t$(this).addClass(\"activeItem\").siblings(\"li\").removeClass(\"activeItem\");\n\n\t\t// grab the index number of the li clicked\n\t\tvar target = $(this).index();\n\n\t\t// find the corresponding dixonStory div and display it, while hiding the others\n\t\t$(this).parent(\"ul\").siblings(\".dixonStory\").addClass(\"noShow\").eq(target).removeClass(\"noShow\");\n\n\t});\n\n\n\n\n\n\n\n\n});\n"],"sourceRoot":"/source/"}